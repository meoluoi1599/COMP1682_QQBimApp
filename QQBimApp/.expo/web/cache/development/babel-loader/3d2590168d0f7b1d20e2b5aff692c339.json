{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nvar _jsxFileName = \"D:\\\\QQBimApp\\\\QQBimApp\\\\App.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useMemo, useReducer } from \"react\";\nimport { NavigationContainer } from \"@react-navigation/native\";\nimport { createStackNavigator } from \"@react-navigation/stack\";\nimport AsyncStorage from '@react-native-community/async-storage';\nimport { StackScreen, DrawerScreen } from \"./src/NavigationScreen\";\nimport { SplashScreen } from \"./src/ScreemFolder/OtherScreen\";\nexport var AuthContext = React.createContext();\nvar RootStack = createStackNavigator();\n\nfunction App(props) {\n  var initialState = {\n    isLoading: true,\n    isSignout: false,\n    userToken: null,\n    userName: null,\n    user: []\n  };\n\n  var reducer = function reducer(state, action) {\n    switch (action.type) {\n      case 'RESTORE_TOKEN':\n        return _objectSpread(_objectSpread({}, state), {}, {\n          userName: action.userName,\n          userToken: action.userToken,\n          user: action.user,\n          isLoading: false\n        });\n\n      case 'SIGN_IN':\n        return _objectSpread(_objectSpread({}, state), {}, {\n          userName: action.userName,\n          user: action.user,\n          isSignout: false,\n          userToken: action.userToken\n        });\n\n      case 'SIGN_OUT':\n        return _objectSpread(_objectSpread({}, state), {}, {\n          userName: null,\n          isSignout: true,\n          userToken: null,\n          user: null\n        });\n\n      default:\n        return state;\n    }\n  };\n\n  var _useReducer = useReducer(reducer, initialState),\n      _useReducer2 = _slicedToArray(_useReducer, 2),\n      state = _useReducer2[0],\n      dispatch = _useReducer2[1];\n\n  var authContext = useMemo(function () {\n    return {\n      signIn: function signIn(res) {\n        var userToken, userName, user;\n        return _regeneratorRuntime.async(function signIn$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                userToken = String(res.token);\n                userName = res.username;\n                console.log(res);\n                user = JSON.stringify(res);\n                _context.prev = 4;\n                _context.next = 7;\n                return _regeneratorRuntime.awrap(AsyncStorage.setItem('userToken', userToken));\n\n              case 7:\n                _context.next = 9;\n                return _regeneratorRuntime.awrap(AsyncStorage.setItem('user', user));\n\n              case 9:\n                _context.next = 14;\n                break;\n\n              case 11:\n                _context.prev = 11;\n                _context.t0 = _context[\"catch\"](4);\n                console.log(_context.t0);\n\n              case 14:\n                dispatch({\n                  type: 'SIGN_IN',\n                  userName: userName,\n                  userToken: userToken,\n                  user: user\n                });\n\n              case 15:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, null, null, [[4, 11]], Promise);\n      },\n      signOut: function signOut() {\n        return _regeneratorRuntime.async(function signOut$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                _context2.next = 3;\n                return _regeneratorRuntime.awrap(AsyncStorage.removeItem('userToken'));\n\n              case 3:\n                _context2.next = 5;\n                return _regeneratorRuntime.awrap(AsyncStorage.removeItem('user'));\n\n              case 5:\n                _context2.next = 10;\n                break;\n\n              case 7:\n                _context2.prev = 7;\n                _context2.t0 = _context2[\"catch\"](0);\n                console.log(_context2.t0);\n\n              case 10:\n                dispatch({\n                  type: 'SIGN_OUT',\n                  userName: null,\n                  userToken: null,\n                  user: null\n                });\n\n              case 11:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, null, null, [[0, 7]], Promise);\n      },\n      signUp: function signUp(res) {\n        var userToken, userName;\n        return _regeneratorRuntime.async(function signUp$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                userToken = String(res.token);\n                userName = res.username;\n                _context3.prev = 2;\n                _context3.next = 5;\n                return _regeneratorRuntime.awrap(AsyncStorage.setItem('userToken', userToken));\n\n              case 5:\n                _context3.next = 10;\n                break;\n\n              case 7:\n                _context3.prev = 7;\n                _context3.t0 = _context3[\"catch\"](2);\n                console.log(_context3.t0);\n\n              case 10:\n                dispatch({\n                  type: 'SIGN_IN',\n                  userName: userName,\n                  userToken: userToken\n                });\n\n              case 11:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, null, null, [[2, 7]], Promise);\n      }\n    };\n  }, []);\n  useEffect(function () {\n    setTimeout(function _callee() {\n      var userToken;\n      return _regeneratorRuntime.async(function _callee$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              userToken = null;\n              _context4.prev = 1;\n              _context4.next = 4;\n              return _regeneratorRuntime.awrap(AsyncStorage.getItem('userToken'));\n\n            case 4:\n              userToken = _context4.sent;\n              _context4.next = 10;\n              break;\n\n            case 7:\n              _context4.prev = 7;\n              _context4.t0 = _context4[\"catch\"](1);\n              console.log(_context4.t0);\n\n            case 10:\n              dispatch({\n                type: 'RESTORE_TOKEN',\n                userToken: userToken\n              });\n\n            case 11:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, null, null, [[1, 7]], Promise);\n    }, 1000);\n  }, []);\n\n  if (state.isLoading) {\n    return React.createElement(SplashScreen, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 7\n      }\n    });\n  }\n\n  console.log('dfdfdfdf' + state.user_id);\n  return React.createElement(AuthContext.Provider, {\n    value: authContext,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 5\n    }\n  }, React.createElement(NavigationContainer, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }\n  }, React.createElement(RootStack.Navigator, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 9\n    }\n  }, state.userToken == null ? React.createElement(RootStack.Screen, {\n    name: \"SignIn\",\n    component: StackScreen,\n    options: {\n      title: 'Sign in',\n      headerShown: false,\n      animationTypeForReplace: state.isSignout ? 'pop' : 'push'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 15\n    }\n  }) : React.createElement(RootStack.Screen, {\n    name: \"Home\",\n    component: DrawerScreen,\n    options: {\n      title: 'Home',\n      headerShown: false\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 15\n    }\n  }))));\n}\n\nexport default App;","map":{"version":3,"sources":["D:/QQBimApp/QQBimApp/App.js"],"names":["React","useEffect","useMemo","useReducer","NavigationContainer","createStackNavigator","AsyncStorage","StackScreen","DrawerScreen","SplashScreen","AuthContext","createContext","RootStack","App","props","initialState","isLoading","isSignout","userToken","userName","user","reducer","state","action","type","dispatch","authContext","signIn","res","String","token","username","console","log","JSON","stringify","setItem","signOut","removeItem","signUp","setTimeout","getItem","user_id","title","headerShown","animationTypeForReplace"],"mappings":"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","sourcesContent":["import React, {useEffect, useMemo, useReducer} from \"react\";\nimport { NavigationContainer } from \"@react-navigation/native\";\nimport { createStackNavigator } from \"@react-navigation/stack\";\nimport AsyncStorage from '@react-native-community/async-storage';\nimport {StackScreen, DrawerScreen} from './src/NavigationScreen';\nimport {SplashScreen} from './src/ScreemFolder/OtherScreen';\n\nexport const AuthContext = React.createContext();\n\nconst RootStack = createStackNavigator();\nfunction App(props) {\n  const initialState = {\n    isLoading: true,\n    isSignout: false,\n    userToken: null,\n    userName: null,\n    user: []\n  }\n\n  const reducer = (state, action) => {\n    switch (action.type) {\n      case 'RESTORE_TOKEN':\n        return {\n          ...state,\n          userName: action.userName,\n          userToken: action.userToken,\n          user: action.user,\n          isLoading: false,\n        };\n      case 'SIGN_IN':\n        return {\n          ...state,\n          userName: action.userName,\n          user: action.user,\n          isSignout: false,\n          userToken: action.userToken,\n        };\n      case 'SIGN_OUT':\n        return {\n          ...state,\n          userName: null,\n          isSignout: true,\n          userToken: null,\n          user: null\n        };\n      default:\n        return state;\n     }\n  }\n \n  const [state, dispatch] = useReducer(reducer, initialState);\n  const authContext = useMemo(() => ({\n    signIn: async(res) => {\n      // setUserToken('fgkj');\n      // setIsLoading(false);\n      const userToken = String(res.token);\n      const userName = res.username;\n      console.log(res);\n      const user = JSON.stringify(res);\n      try {\n        await AsyncStorage.setItem('userToken', userToken);\n        await AsyncStorage.setItem('user', user);\n      } catch(e) {\n        console.log(e);\n      }\n      dispatch({ type: 'SIGN_IN', userName: userName, userToken: userToken, user: user});\n    },\n    signOut: async() => {\n      // setUserToken(null);\n      // setIsLoading(false);\n      try {\n        await AsyncStorage.removeItem('userToken');\n        await AsyncStorage.removeItem('user');\n      } catch(e) {\n        console.log(e);\n      }\n      dispatch({ type: 'SIGN_OUT', userName: null, userToken: null, user: null });\n    },\n    signUp: async(res) => {\n      const userToken = String(res.token);\n      const userName = res.username;\n      try {\n        await AsyncStorage.setItem('userToken', userToken);\n      } catch(e) {\n        console.log(e);\n      }\n      dispatch({ type: 'SIGN_IN', userName: userName, userToken: userToken });\n    },\n  }), []);\n\n  useEffect(() => {\n    setTimeout(async() => {\n      // setIsLoading(false);\n      let userToken;\n      userToken = null;\n      try {\n        userToken = await AsyncStorage.getItem('userToken');\n      } catch(e) {\n        console.log(e);\n      }\n      // console.log('user token: ', userToken);\n      dispatch({ type: 'RESTORE_TOKEN', userToken: userToken });\n    }, 1000);\n  }, []);\n\n  if( state.isLoading ) {\n    return(\n      <SplashScreen/>\n    );\n  }\n  console.log('dfdfdfdf' + state.user_id)\n  return (\n    <AuthContext.Provider value={authContext}>\n      <NavigationContainer>\n        <RootStack.Navigator>\n          {state.userToken == null ? (\n              // No token found, user isn't signed in\n              <RootStack.Screen\n                name=\"SignIn\"\n                component={StackScreen}\n                options={{\n                  title: 'Sign in',\n                  headerShown: false,\n              // When logging out, a pop animation feels intuitive\n                  animationTypeForReplace: state.isSignout ? 'pop' : 'push',\n                }}\n              />\n            ) : (\n              \n              // User is signed in\n              <RootStack.Screen name=\"Home\" component={DrawerScreen}  options={{\n                title: 'Home',\n                headerShown: false}}/>\n            )}\n        </RootStack.Navigator>\n      </NavigationContainer>\n    </AuthContext.Provider>\n\n  );\n}\nexport default App;"]},"metadata":{},"sourceType":"module"}