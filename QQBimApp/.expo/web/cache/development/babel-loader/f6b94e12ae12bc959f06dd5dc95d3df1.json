{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"D:\\\\QQBimApp\\\\QQBimApp\\\\src\\\\users\\\\ScreemFolder\\\\NotificationScreen\\\\ChatScreen.js\";\nimport React from 'react';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport View from \"react-native-web/dist/exports/View\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport AsyncStorage from \"react-native-web/dist/exports/AsyncStorage\";\nimport { Ionicons } from '@expo/vector-icons';\nimport { SplashScreen } from \"../OtherScreen\";\n\nfunction ChatScreen(props) {\n  var _React$useState = React.useState([]),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      chatMessage = _React$useState2[0],\n      setChatMessage = _React$useState2[1];\n\n  var _React$useState3 = React.useState(''),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      contentMassage = _React$useState4[0],\n      setContentMassage = _React$useState4[1];\n\n  var _React$useState5 = React.useState(true),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      isLoading = _React$useState6[0],\n      setLoading = _React$useState6[1];\n\n  var _React$useState7 = React.useState([]),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      dataUser = _React$useState8[0],\n      setDataUser = _React$useState8[1];\n\n  React.useEffect(function () {\n    props.navigation.dangerouslyGetParent().setOptions({\n      tabBarVisible: false\n    });\n    getData();\n    getMessage();\n  }, []);\n\n  var getData = function getData() {\n    return _regeneratorRuntime.async(function getData$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            try {\n              AsyncStorage.getItem('user').then(function (value) {\n                var jsonValue = JSON.parse(value);\n                setDataUser(jsonValue);\n              });\n            } catch (e) {\n              console.log(e);\n            }\n\n          case 1:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var getMessage = function getMessage() {\n    fetch('http://192.168.0.101:19000/get_messages/' + props.route.params.item.contact_id).then(function (response) {\n      return response.json();\n    }).then(function (res) {\n      setChatMessage(res);\n    }).catch(function (error) {\n      console.log(error);\n    }).finally(function () {\n      setLoading(false);\n    });\n  };\n\n  function submitChatMessage() {\n    fetch('http://192.168.0.101:19000/send_message', {\n      method: 'POST',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        'sender_id': dataUser.user_id,\n        'messages_content': contentMassage,\n        'contact_id': props.route.params.item.contact_id\n      })\n    }).then(function (response) {\n      return response.json();\n    }).then(function (res) {\n      getMessage();\n      setContentMassage('');\n    }).catch(function (error) {\n      console.log(error);\n    });\n  }\n\n  return React.createElement(View, {\n    style: styles.container,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }\n  }, React.createElement(View, {\n    style: {\n      flex: 1\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 9\n    }\n  }, isLoading ? React.createElement(SplashScreen, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 23\n    }\n  }) : React.createElement(FlatList, {\n    data: chatMessage,\n    keyExtractor: function keyExtractor(item) {\n      return item.contact_id.toString();\n    },\n    renderItem: function renderItem(_ref) {\n      var item = _ref.item;\n      return React.createElement(View, {\n        style: {\n          flex: 1,\n          flexDirection: 'column'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 17\n        }\n      }, item.sender_id != dataUser.user_id ? React.createElement(View, {\n        style: {\n          flex: 1,\n          flexDirection: 'row',\n          marginTop: 10,\n          marginRight: '20%'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 21\n        }\n      }, React.createElement(Image, {\n        style: styles.img,\n        source: {\n          uri: item.user_avatar\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 23\n        }\n      }), React.createElement(View, {\n        style: [styles.chatmessage, {\n          backgroundColor: 'white',\n          marginLeft: 10\n        }],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 22\n        }\n      }, React.createElement(Text, {\n        style: styles.textName,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 24\n        }\n      }, item.massage_content))) : React.createElement(View, {\n        style: {\n          flex: 1,\n          flexDirection: 'row',\n          marginTop: 10,\n          marginLeft: '20%'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 21\n        }\n      }, React.createElement(View, {\n        style: [styles.chatmessage, {\n          backgroundColor: 'lightblue',\n          marginRight: 10\n        }],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 23\n        }\n      }, React.createElement(Text, {\n        style: styles.textName,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 25\n        }\n      }, item.massage_content)), React.createElement(Image, {\n        style: styles.img,\n        source: {\n          uri: item.user_avatar\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 23\n        }\n      })));\n    },\n    showsHorizontalScrollIndicator: false,\n    ListEmptyComponent: ListEmpty,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 13\n    }\n  })), React.createElement(View, {\n    style: {\n      justifyContent: 'flex-end',\n      backgroundColor: 'white',\n      width: '100%',\n      height: 50,\n      flexDirection: 'row',\n      paddingRight: 5\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 9\n    }\n  }, React.createElement(TextInput, {\n    style: {\n      height: 40,\n      margin: 5,\n      backgroundColor: '#f2f2f2',\n      width: '80%'\n    },\n    autoCorrect: false,\n    placeholder: \"Enter message....\",\n    value: contentMassage,\n    onSubmitEditing: function onSubmitEditing() {\n      return submitChatMessage();\n    },\n    onChangeText: function onChangeText(text) {\n      return setContentMassage(text);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 11\n    }\n  }), React.createElement(TouchableOpacity, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 11\n    }\n  }, React.createElement(Ionicons, {\n    name: \"md-send\",\n    size: 45,\n    color: \"#aa4fff\",\n    style: {\n      marginLeft: 10,\n      marginRight: 10\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 13\n    }\n  }))));\n\n  function ListEmpty() {\n    return React.createElement(View, {\n      style: {\n        justifyContent: 'center',\n        alignItems: 'center'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 9\n      }\n    }, React.createElement(Text, {\n      style: {\n        fontSize: 18,\n        fontWeight: 'bold',\n        textAlign: 'center'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 11\n      }\n    }, \"Send message to start communication!!\"));\n  }\n}\n\nexport { ChatScreen };\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: 'flex-start',\n    flexDirection: 'column',\n    marginTop: 10,\n    borderColor: '#8a2be2'\n  },\n  chatmessage: {\n    width: '80%',\n    shadowColor: \"#000\",\n    shadowOffset: {\n      width: 0,\n      height: 2\n    },\n    shadowOpacity: 0.25,\n    shadowRadius: 3.84,\n    elevation: 5,\n    padding: 10,\n    borderRadius: 20\n  },\n  img: {\n    width: 40,\n    height: 40,\n    borderRadius: 50\n  },\n  textName: {\n    fontSize: 18,\n    fontWeight: 'bold',\n    marginLeft: 20\n  }\n});","map":{"version":3,"sources":["D:/QQBimApp/QQBimApp/src/users/ScreemFolder/NotificationScreen/ChatScreen.js"],"names":["React","Ionicons","SplashScreen","ChatScreen","props","useState","chatMessage","setChatMessage","contentMassage","setContentMassage","isLoading","setLoading","dataUser","setDataUser","useEffect","navigation","dangerouslyGetParent","setOptions","tabBarVisible","getData","getMessage","AsyncStorage","getItem","then","value","jsonValue","JSON","parse","e","console","log","fetch","route","params","item","contact_id","response","json","res","catch","error","finally","submitChatMessage","method","headers","Accept","body","stringify","user_id","styles","container","flex","toString","flexDirection","sender_id","marginTop","marginRight","img","uri","user_avatar","chatmessage","backgroundColor","marginLeft","textName","massage_content","ListEmpty","justifyContent","width","height","paddingRight","margin","text","alignItems","fontSize","fontWeight","textAlign","StyleSheet","create","borderColor","shadowColor","shadowOffset","shadowOpacity","shadowRadius","elevation","padding","borderRadius"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { StyleSheet, Dimensions, View, TextInput, Text, TouchableOpacity, FlatList, Image, AsyncStorage} from 'react-native';\r\nimport { Ionicons } from '@expo/vector-icons'; \r\nimport {SplashScreen} from '../OtherScreen'\r\n\r\nfunction ChatScreen(props) {\r\n    const [chatMessage, setChatMessage] = React.useState([]);\r\n    const [contentMassage, setContentMassage] = React.useState('');\r\n    const [isLoading, setLoading] = React.useState(true);\r\n    const [dataUser, setDataUser] = React.useState([]);\r\n\r\n    React.useEffect(() => {\r\n      props.navigation.dangerouslyGetParent().setOptions({\r\n        tabBarVisible: false\r\n      });\r\n      getData();\r\n      getMessage();\r\n    },[]);\r\n    const getData = async () => {\r\n      try {\r\n        AsyncStorage.getItem('user').then((value) => {\r\n          const jsonValue = JSON.parse(value);\r\n          setDataUser(jsonValue);\r\n        })\r\n      } catch(e) {\r\n        console.log(e)\r\n      }\r\n    }\r\n\r\n    const getMessage=()=> {\r\n      fetch('http://192.168.0.101:19000/get_messages/' + props.route.params.item.contact_id)\r\n      .then ((response) => response.json())\r\n      .then ( (res) => { \r\n        setChatMessage(res);\r\n      })\r\n      .catch ((error) => {\r\n        console.log(error);\r\n      })\r\n      .finally(() => {\r\n        setLoading(false) \r\n      });\r\n    }\r\n\r\n    function submitChatMessage() {\r\n      fetch('http://192.168.0.101:19000/send_message', {\r\n        method: 'POST',\r\n        headers: {\r\n            Accept: 'application/json',\r\n            'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n            'sender_id': dataUser.user_id,\r\n            'messages_content': contentMassage,\r\n            'contact_id' : props.route.params.item.contact_id\r\n        })\r\n    })\r\n    .then ((response) => response.json())\r\n    .then ( (res) => { \r\n        getMessage();\r\n        setContentMassage('');\r\n    })\r\n    .catch ((error) => {\r\n        console.log(error);\r\n    })\r\n    }\r\n    return (\r\n      <View style={styles.container}>\r\n        <View style={{flex: 1}}>\r\n          {isLoading? <SplashScreen/>:(\r\n            <FlatList\r\n              data={chatMessage}\r\n              keyExtractor= {item => item.contact_id.toString()}\r\n              renderItem={({ item }) => (\r\n                <View style={{flex: 1, flexDirection: 'column'}}>\r\n                  {item.sender_id != dataUser.user_id ? (\r\n                    <View style={{flex: 1, flexDirection: 'row', marginTop: 10, marginRight: '20%'}}>\r\n                      <Image\r\n                         style={styles.img}\r\n                         source= {{uri: item.user_avatar}}\r\n                       />\r\n                     <View style={[styles.chatmessage, {backgroundColor: 'white', marginLeft: 10}]}>\r\n                       <Text style={styles.textName}>{item.massage_content}</Text>\r\n                     </View>\r\n                   </View>\r\n                  ): (\r\n                    <View style={{flex: 1, flexDirection: 'row', marginTop: 10, marginLeft: '20%'}}>\r\n                      <View style={[styles.chatmessage, {backgroundColor: 'lightblue', marginRight: 10}]}>\r\n                        <Text style={styles.textName}>{item.massage_content}</Text>\r\n                      </View>\r\n                      <Image\r\n                          style={styles.img}\r\n                          source= {{uri: item.user_avatar}}\r\n                        />\r\n                    </View>\r\n                  )}\r\n                </View>\r\n              )}  \r\n              showsHorizontalScrollIndicator={false}\r\n              ListEmptyComponent={ListEmpty}\r\n            /> \r\n          )}\r\n        </View>\r\n        <View style={{justifyContent: 'flex-end', backgroundColor: 'white', width: '100%', height: 50, flexDirection: 'row', paddingRight: 5}}>\r\n          <TextInput\r\n            style={{ height: 40, margin: 5, backgroundColor: '#f2f2f2', width: '80%'}}\r\n            autoCorrect={false}\r\n            placeholder= 'Enter message....'\r\n            value={contentMassage}\r\n            onSubmitEditing={() => submitChatMessage()}\r\n            onChangeText={text =>  setContentMassage(text)}\r\n          />\r\n          <TouchableOpacity>\r\n            <Ionicons name=\"md-send\" size={45} color=\"#aa4fff\" style={{ marginLeft: 10, marginRight: 10}} />\r\n          </TouchableOpacity>\r\n        </View>\r\n      </View>\r\n    )   \r\n\r\n    function ListEmpty() {\r\n      return(\r\n        <View style={{justifyContent: 'center', alignItems: 'center'}}>\r\n          <Text style={{fontSize: 18, fontWeight: 'bold', textAlign: 'center'}}>Send message to start communication!!</Text>\r\n        </View>\r\n      )\r\n    }\r\n} export {ChatScreen};\r\n \r\nconst styles = StyleSheet.create({\r\n    container: {\r\n        flex: 1,\r\n        justifyContent: 'flex-start',\r\n        flexDirection: 'column',\r\n        marginTop: 10,\r\n        borderColor: '#8a2be2',\r\n    },\r\n    chatmessage: {\r\n      width: '80%',\r\n      shadowColor: \"#000\",\r\n      shadowOffset: {\r\n        width: 0,\r\n        height: 2,\r\n      },\r\n      shadowOpacity: 0.25,\r\n      shadowRadius: 3.84,\r\n      elevation: 5,\r\n      padding: 10,\r\n      borderRadius: 20\r\n    },\r\n    img: {\r\n      width: 40, \r\n      height: 40, \r\n      borderRadius: 50\r\n    },\r\n    textName: {\r\n      fontSize: 18, \r\n      fontWeight: 'bold', \r\n      marginLeft: 20}\r\n\r\n});"]},"metadata":{},"sourceType":"module"}